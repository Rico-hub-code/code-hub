<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Submit Student Data</title>

    <style>
        body{
            background-color: #d6d6d6;
            font-family: Arial, Helvetica, sans-serif;
        }
        
        .error {
            color: white;
            background-color: red;
            padding: 10px;
            margin-top: 10px;
            display: none; 
            border-radius: 5px;
        }

        .success{
            display:none; 
            color: green; 
            margin-top: 20px;
            padding: 5px;
            margin-left: 150px;
        }
        
        input{
            width: 150px;
            padding: 5px;
            font-size: 14px;
            margin-left: 15px;
            margin-bottom: 5px;
        }
        
        .grid-container {
            display: flex; 
            margin-bottom: 20px;
            justify-content: center;
        }
        
        .key{
            margin-left: 15px;
        }
        
        .kay{
            margin-left: 15px;
        }
        
        button{
            margin: 20px 0 0 140px;
            padding: 10px;
            width: 30%;
            font-size: 15px;
            margin-bottom: 15px;
        } 
        
        h2{
            margin-top: 30px;
            margin-left: 100px;
        }
        
        @media  screen and (min-width: 1024px) {
            .key{
                margin-left: 15px;
            }
            
            .kay{
                margin-left: 30px;
            }

            .success{
                margin-left: 500px;
            }
            
            h2{
                margin: 30px 0 30px 590px;
            }
        
            button{
                margin: 5px 0 30px 300px;
                padding: 10px;
                width: 15%;
                font-size: 15px;
            }
        
            input{
                width: 200px;
                padding: 5px;
                font-size: 14px;
                margin-left: 15px;
                margin-bottom: 5px;
            }
        
            form{
                width: 50%;
                background-color: rgb(184, 183, 183);
                margin-left: 350px;
                border-radius: 10px;
            }
        }
    </style>

</head>
<body>
    <h2>Group Registration</h2>
    <form id="dataForm">
        <div class="grid-container">
            <!-- Names Grid -->
            <div id="namesGrid">
                <h3 class="kay">Names</h3>
                <div class="input-group">
                    <label for="name1">1:</label>
                    <input type="text" id="name1" name="name1" required>
                </div>
                <div class="input-group">
                    <label for="name2">2:</label>
                    <input type="text" id="name2" name="name2" required>
                </div>
                <div class="input-group">
                    <label for="name3">3:</label>
                    <input type="text" id="name3" name="name3" required>
                </div>
                <div class="input-group">
                    <label for="name4">4:</label>
                    <input type="text" id="name4" name="name4" required>
                </div>
                <div class="input-group">
                    <label for="name5">5:</label>
                    <input type="text" id="name5" name="name5" required>
                </div>
                <div class="input-group">
                    <label for="name6">6:</label>
                    <input type="text" id="name6" name="name6" required>
                </div>
                <div class="input-group">
                    <label for="name7">7:</label>
                    <input type="text" id="name7" name="name7" required>
                </div>
                <div class="input-group">
                    <label for="name8">8:</label>
                    <input type="text" id="name8" name="name8" required>
                </div>
                <div class="input-group">
                    <label for="name9">9:</label>
                    <input type="text" id="name9" name="name9" required>
                </div>
                <div class="input-group">
                    <label for="name10">X:</label>
                    <input type="text" id="name10" name="name10" required>
                </div>
            </div>

            <!-- Student Numbers Grid -->
            <div id="studentNumbersGrid">
                <h3 class="key">Student Numbers</h3>
                <div class="input-group">
                    <input type="text" id="studentNumber1" name="studentNumber1" required>
                </div>
                <div class="input-group">
                    <input type="text" id="studentNumber2" name="studentNumber2" required>
                </div>
                <div class="input-group">
                    <input type="text" id="studentNumber3" name="studentNumber3" required>
                </div>
                <div class="input-group">
                    <input type="text" id="studentNumber4" name="studentNumber4" required>
                </div>
                <div class="input-group">
                    <input type="text" id="studentNumber5" name="studentNumber5" required>
                </div>
                <div class="input-group">
                    <input type="text" id="studentNumber6" name="studentNumber6" required>
                </div>
                <div class="input-group">
                    <input type="text" id="studentNumber7" name="studentNumber7" required>
                </div>
                <div class="input-group">
                    <input type="text" id="studentNumber8" name="studentNumber8" required>
                </div>
                <div class="input-group">
                    <input type="text" id="studentNumber9" name="studentNumber9" required>
                </div>
                <div class="input-group">
                    <input type="text" id="studentNumber10" name="studentNumber10" required>
                </div>
            </div>
        </div>

        <button type="submit">Submit</button>
    </form>

    <div id="successMessage" class="success"></div>
    <div id="errorMessages" class="error"></div>

</body>

<script>
    const form = document.forms['dataForm'];
const errorMessagesDiv = document.getElementById('errorMessages');
const successMessageDiv = document.getElementById('successMessage');

// Function to validate names (only letters and spaces allowed)
function validateName(name) {
    const nameRegex = /^[A-Za-z\s]+$/;
    return nameRegex.test(name);
}

// Function to validate student numbers (only numbers allowed)
function validateStudentNumber(number) {
    const numberRegex = /^\d+$/;
    return numberRegex.test(number);
}

form.addEventListener('submit', e => {
    e.preventDefault();
    
    let isValid = true;
    const errorMessage = [];

    // Clear previous error messages
    errorMessagesDiv.innerHTML = '';
    errorMessagesDiv.style.display = 'none';
    
    // Clear success message
    successMessageDiv.innerHTML = '';
    successMessageDiv.style.display = 'none';

    // Loop through the 10 name and student number pairs
    for (let i = 1; i <= 10; i++) {
        const name = document.getElementById(`name${i}`).value.trim();
        const studentNumber = document.getElementById(`studentNumber${i}`).value.trim();
        
        // Validate Name
        if (!validateName(name)) {
            isValid = false;
            errorMessage.push(`Name ${i} is invalid. Only letters and spaces are allowed.`);
        }

        // Validate Student Number
        if (!validateStudentNumber(studentNumber)) {
            isValid = false;
            errorMessage.push(`Student Number ${i} is invalid. Only numbers are allowed.`);
        }
    }

    // Show error messages if validation fails
    if (!isValid) {
        errorMessagesDiv.innerHTML = errorMessage.join("<br>");
        errorMessagesDiv.style.display = 'block'; // Show the error message div
        return;
    }

    // If all inputs are valid, send data to Google Apps Script
    const formData = new FormData(form);
    const scriptURL = 'https://script.google.com/macros/s/AKfycbzInNxHax6tkuQHtrD1ZwjZiF734BmNb-BmiTtQHWdAFWvXi38F_7qhErLBLdtKM8k1/exec';
    fetch(scriptURL, { method: 'POST', body: formData })
        .then(response => {
            if (response.ok) {
                // Show success message
                successMessageDiv.innerHTML = "Data posted successfully!";
                successMessageDiv.style.display = 'block';
                
                // Optional: Reset the form after submission
                form.reset();
            } else {
                throw new Error('Network response was not ok.');
            }
        })
        .catch(error => {
            errorMessagesDiv.innerHTML = 'There was a problem submitting the data.';
            errorMessagesDiv.style.display = 'block';
        });
});

</script>
</html>
